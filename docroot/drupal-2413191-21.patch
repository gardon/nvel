From da08efd48c8a5ce456427ee7adfc6cfea93645e5 Mon Sep 17 00:00:00 2001
From: Dane Powell <git@danepowell.com>
Date: Mon, 13 Feb 2017 13:20:23 -0800
Subject: [PATCH] Issue #2413191 by Dane Powell: Fixed multilingual install
 depends on locale module.

---
 core/includes/install.core.inc | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/core/includes/install.core.inc b/core/includes/install.core.inc
index 839b038..bbff580 100644
--- a/core/includes/install.core.inc
+++ b/core/includes/install.core.inc
@@ -717,7 +717,8 @@ function install_tasks($install_state) {
   // 'install_import_translations' task. Import when a non-English language is
   // available and selected. Also we will need translations even if the
   // installer language is English but there are other languages on the system.
-  $needs_translations = (count($install_state['translations']) > 1 && !empty($install_state['parameters']['langcode']) && $install_state['parameters']['langcode'] != 'en') || \Drupal::languageManager()->isMultilingual();
+  $locale_module_exists = \Drupal::moduleHandler()->moduleExists('locale');
+  $needs_translations = $locale_module_exists && ((count($install_state['translations']) > 1 && !empty($install_state['parameters']['langcode']) && $install_state['parameters']['langcode'] != 'en') || \Drupal::languageManager()->isMultilingual());
   // Determine whether a translation file must be downloaded during the
   // 'install_download_translation' task. Download when a non-English language
   // is selected, but no translation is yet in the translations directory.
-- 
2.7.4

